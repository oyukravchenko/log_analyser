__Описание__

Анализатор логов nginx 

__Основная функциональность__

1. Скрипт обрабатывает при запуске последний (со самой свежей датой в имени, не по mtime файла!) лог в `LOG_DIR`, в результате работы получается отчет как в `report-2017.06.30.html` . То есть скрипт читает лог, парсит нужные поля, считает необходимую статистику по url'ам и рендерит шаблон `report.html` (в шаблоне нужно только подставить `$table_json`) в `report-YYYY.MM.DD.html`, где дата в названии соответствует дате обработанного файла логов . Ситуация, что логов на обработку нет возможна, это не должно являться ошибкой.  
2. Готовые отчеты лежат в `REPORT_DIR`. В отчет попадает `REPORT_SIZE` URL'ов с наибольшим суммарным временем обработки (`time_sum`).
3. Скрипту можно указать считать конфиг из другого файла, передав его путь через `--config`. У пути конфига должно быть дефолтное значение. Если файл не существует или не парсится, нужно выходить с ошибкой.
4. В переменной `config` находится конфиг по умолчанию. В конфиге, считанном из файла, могут быть переопределены перменные дефолтного конфига (некоторые, все или никакие, т.е. файл может быть пустой) и они имеют более высокий приоритет по сравнению с дефолтным конфигом. Таким образом, результирующий конфиг получается слиянием конфига из файла и дефолтного, с приоритетом конфига из файла. Ситуацию, когда конфига на диске не оказалось, нужно исключить.
5. Если скрипт удачно обработал, то работу не переделывает при повторном запуске. Информация об обработанных файлах хранится в LOG_DIR/.processed.txt


__Как запустить__

Создать виртуальное окружение 
```
pyenv install python=3.10.9
```
Установка poetry
```
pip install poetry==1.8.4
```
Установка зависимостей
```
poetry install
```
Запуск тестов
```
poetry run make test
```
Запуск скрипта с дефолтным конфигом local.config
```
python log_analyzer/log_analyzer.py
```
либо с явным указанием конфига
```
python log_analyzer/log_analyzer.py --config local.config
```

**Пример ожидаемого формата лога**

data/logs/nginx-access-ui.log-20240730

**Пример отчета**

data/reports/report-2024.07.30.htlm